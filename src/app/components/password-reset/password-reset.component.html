<div class="password-reset-container">
  <!-- Modern Header -->
  <div class="modern-header">
    <div class="header-content">
      <div class="header-text">
        <div class="welcome-icon">
          <i class="fas fa-key"></i>
        </div>
        <h1 class="modern-title">
          {{ currentStep === 'forgot' ? 'Reset Your Password' : 'Create New Password' }}
        </h1>
        <p class="modern-subtitle">
          {{ currentStep === 'forgot' ? 'Enter your email to receive a password reset link' : 'Enter your new password to complete the reset process' }}
        </p>
      </div>
      <div class="header-actions">
        <button class="btn-modern-secondary" (click)="goBack()">
          <i class="fas fa-arrow-left"></i>
          <span>Back to Login</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Modern Form Container -->
  <div class="modern-form-container">
    <div class="form-wrapper">
      
      <!-- Forgot Password Step -->
      <div *ngIf="currentStep === 'forgot'" class="step-container">
        <div class="form-header">
          <div class="form-icon">
            <i class="fas fa-envelope"></i>
          </div>
          <h2 class="form-title">Forgot Password</h2>
          <p class="form-description">
            Enter your email address and we'll send you a password reset token
          </p>
        </div>

        <form [formGroup]="forgotPasswordForm" (ngSubmit)="onForgotPassword()" class="modern-form">
          <div class="form-field">
            <label for="email" class="field-label">
              <i class="fas fa-envelope field-icon"></i>
              Email Address
              <span class="required">*</span>
            </label>
            <div class="input-container">
              <input
                type="email"
                id="email"
                formControlName="email"
                [class]="getFieldClasses(forgotPasswordForm.get('email'))"
                placeholder="Enter your email address"
                class="modern-input">
              <div class="input-focus-border"></div>
            </div>
            <div class="field-feedback" *ngIf="hasError(forgotPasswordForm.get('email'))">
              <i class="fas fa-exclamation-circle"></i>
              {{ getErrorMessage(forgotPasswordForm.get('email'), 'Email') }}
            </div>
          </div>

          <div class="form-actions">
            <button
              type="submit"
              class="btn-modern-primary"
              [disabled]="forgotPasswordForm.invalid || isSubmitting">
              <div class="btn-content">
                <i class="fas fa-paper-plane" *ngIf="!isSubmitting"></i>
                <div class="spinner" *ngIf="isSubmitting">
                  <div class="spinner-circle"></div>
                </div>
                <span>{{ isSubmitting ? 'Sending...' : 'Send Reset Token' }}</span>
              </div>
            </button>
          </div>
        </form>
      </div>

      <!-- Reset Password Step -->
      <div *ngIf="currentStep === 'reset'" class="step-container">
        <div class="form-header">
          <div class="form-icon">
            <i class="fas fa-lock"></i>
          </div>
          <h2 class="form-title">Reset Password</h2>
          <p class="form-description">
            Enter your reset token and create a new password
          </p>
        </div>

        <form [formGroup]="resetPasswordForm" (ngSubmit)="onResetPassword()" class="modern-form">
          <div class="form-grid">
            <!-- Reset Token Field -->
            <div class="form-field">
              <label for="token" class="field-label">
                <i class="fas fa-key field-icon"></i>
                Reset Token
                <span class="required">*</span>
              </label>
              <div class="input-container">
                <input
                  type="text"
                  id="token"
                  formControlName="token"
                  [class]="getFieldClasses(resetPasswordForm.get('token'))"
                  placeholder="Enter your reset token"
                  class="modern-input">
                <div class="input-focus-border"></div>
              </div>
              <div class="field-feedback" *ngIf="hasError(resetPasswordForm.get('token'))">
                <i class="fas fa-exclamation-circle"></i>
                {{ getErrorMessage(resetPasswordForm.get('token'), 'Reset Token') }}
              </div>
              <div class="field-hint">
                <i class="fas fa-info-circle"></i>
                Token received via email or from forgot password response
              </div>
            </div>

            <!-- New Password Field -->
            <div class="form-field">
              <label for="newPassword" class="field-label">
                <i class="fas fa-lock field-icon"></i>
                New Password
                <span class="required">*</span>
              </label>
              <div class="input-container password-container">
                <input
                  [type]="showNewPassword ? 'text' : 'password'"
                  id="newPassword"
                  formControlName="newPassword"
                  [class]="getFieldClasses(resetPasswordForm.get('newPassword'))"
                  placeholder="Enter your new password"
                  class="modern-input">
                <button
                  type="button"
                  class="password-toggle"
                  (click)="toggleNewPasswordVisibility()">
                  <i class="fas" [class.fa-eye]="!showNewPassword" [class.fa-eye-slash]="showNewPassword"></i>
                </button>
                <div class="input-focus-border"></div>
              </div>
              <div class="field-feedback" *ngIf="hasError(resetPasswordForm.get('newPassword'))">
                <i class="fas fa-exclamation-circle"></i>
                {{ getErrorMessage(resetPasswordForm.get('newPassword'), 'New Password') }}
              </div>
              
              <!-- Password Strength Indicator -->
              <div class="password-strength" *ngIf="resetPasswordForm.get('newPassword')?.value">
                <div class="strength-header">
                  <span class="strength-label">Password Strength:</span>
                  <span class="strength-text" [class]="'strength-' + getPasswordStrength().color">
                    {{ getPasswordStrength().strength }}
                  </span>
                </div>
                <div class="strength-bar">
                  <div class="strength-fill" [class]="'strength-' + getPasswordStrength().color" [style.width.%]="getPasswordStrength().percentage"></div>
                </div>
                <div class="password-requirements">
                  <i class="fas fa-info-circle"></i>
                  Must contain uppercase, lowercase, number, and special character
                </div>
              </div>
            </div>

            <!-- Confirm Password Field -->
            <div class="form-field">
              <label for="confirmPassword" class="field-label">
                <i class="fas fa-lock field-icon"></i>
                Confirm Password
                <span class="required">*</span>
              </label>
              <div class="input-container password-container">
                <input
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  id="confirmPassword"
                  formControlName="confirmPassword"
                  [class]="getFieldClasses(resetPasswordForm.get('confirmPassword'))"
                  placeholder="Confirm your new password"
                  class="modern-input">
                <button
                  type="button"
                  class="password-toggle"
                  (click)="toggleConfirmPasswordVisibility()">
                  <i class="fas" [class.fa-eye]="!showConfirmPassword" [class.fa-eye-slash]="showConfirmPassword"></i>
                </button>
                <div class="input-focus-border"></div>
              </div>
              <div class="field-feedback" *ngIf="hasError(resetPasswordForm.get('confirmPassword'))">
                <i class="fas fa-exclamation-circle"></i>
                {{ getErrorMessage(resetPasswordForm.get('confirmPassword'), 'Confirm Password') }}
              </div>
            </div>
          </div>

          <div class="form-actions">
            <div class="actions-left">
              <button
                type="button"
                class="btn-modern-secondary"
                (click)="validateToken()"
                [disabled]="!resetPasswordForm.get('token')?.value || isSubmitting">
                <i class="fas fa-check-circle"></i>
                <span>Validate Token</span>
              </button>
            </div>
            <div class="actions-right">
              <button
                type="submit"
                class="btn-modern-primary"
                [disabled]="resetPasswordForm.invalid || isSubmitting">
                <div class="btn-content">
                  <i class="fas fa-save" *ngIf="!isSubmitting"></i>
                  <div class="spinner" *ngIf="isSubmitting">
                    <div class="spinner-circle"></div>
                  </div>
                  <span>{{ isSubmitting ? 'Resetting...' : 'Reset Password' }}</span>
                </div>
              </button>
            </div>
          </div>
        </form>
      </div>

      <!-- Success Step -->
      <div *ngIf="currentStep === 'success'" class="step-container">
        <div class="success-container">
          <div class="success-icon">
            <i class="fas fa-check-circle"></i>
          </div>
          <h2 class="success-title">Password Reset Successful!</h2>
          <p class="success-message">
            Your password has been reset successfully. You can now login with your new password.
          </p>
          <div class="success-actions">
            <button class="btn-modern-primary" (click)="goToLogin()">
              <i class="fas fa-sign-in-alt"></i>
              <span>Go to Login</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modern Help Section -->
  <div class="modern-help-section">
    <div class="help-header">
      <div class="help-icon">
        <i class="fas fa-question-circle"></i>
      </div>
      <h3 class="help-title">Password Reset Guidelines</h3>
    </div>
    <div class="help-content">
      <div class="help-grid">
        <div class="help-card">
          <div class="help-card-header">
            <i class="fas fa-shield-alt"></i>
            <h4>Password Requirements</h4>
          </div>
          <ul class="help-list">
            <li><i class="fas fa-check"></i> Minimum 8 characters long</li>
            <li><i class="fas fa-check"></i> At least one uppercase letter (A-Z)</li>
            <li><i class="fas fa-check"></i> At least one lowercase letter (a-z)</li>
            <li><i class="fas fa-check"></i> At least one number (0-9)</li>
            <li><i class="fas fa-check"></i> At least one special character (@$!%*?&)</li>
          </ul>
        </div>
        <div class="help-card">
          <div class="help-card-header">
            <i class="fas fa-clock"></i>
            <h4>Reset Process</h4>
          </div>
          <ul class="help-list">
            <li><i class="fas fa-envelope"></i> <strong>Step 1:</strong> Enter your email address</li>
            <li><i class="fas fa-key"></i> <strong>Step 2:</strong> Use the reset token received</li>
            <li><i class="fas fa-lock"></i> <strong>Step 3:</strong> Create your new password</li>
            <li><i class="fas fa-exclamation-triangle"></i> <strong>Note:</strong> Token expires in 24 hours</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>



